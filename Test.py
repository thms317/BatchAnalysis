import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import leastsq
from scipy.optimize import curve_fit

NRLs = [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202]
G1 = [[24.502, 21.277, 18.374, 18.49, 17.531, 16.956, 16.971, 16.018, 16.214, 18.217, 17.289, 18.376, 16.933, 17.205, 17.545, 19.136, 18.364, 19.318, 20.642, 21.475, 21.345, 25.821, 17.119, 16.817, 21.857, 18.774, 17.728, 19.748, 17.462, 17.563, 16.478, 17.171, 18.605, 17.767, 18.404], [19.058, 18.931, 17.861, 17.456, 21.592, 18.074, 21.217, 18.229, 15.999, 17.748, 22.96, 23.192, 19.019, 19.628, 24.244, 18.311, 20.029, 18.797, 21.795, 17.938, 24.81, 23.392, 17.977, 18.493, 19.876, 21.114, 18.544, 20.182, 21.37, 23.369, 23.692, 18.999, 21.158, 21.529, 22.307, 21.248, 21.356, 20.539, 16.935, 24.004, 23.537, 18.105, 17.779, 22.404, 18.8, 19.712, 21.71, 22.991, 23.896], [18.553, 19.939, 18.927, 18.5, 16.231, 19.084, 18.195, 18.757, 20.228, 19.025, 13.058, 21.229, 21.339, 17.392, 16.909, 18.438, 22.488, 20.865, 17.265, 23.482, 21.597, 21.992, 22.568, 26.45, 22.79, 21.558, 19.427, 15.975, 21.7, 21.829, 22.524, 20.284, 25.13, 23.024, 19.956, 20.702, 22.916, 22.643, 24.977, 21.223, 23.728, 22.491, 21.797, 24.978, 24.463, 24.007, 23.745, 20.327, 24.167, 25.341, 25.63, 24.118, 25.331, 23.028, 23.049, 22.96, 20.496, 15.246, 23.651], [21.645, 24.328, 18.426, 17.546, 20.887, 18.473, 23.608, 25.19, 20.856, 19.833, 22.693, 21.705, 21.293, 20.31, 21.871, 19.295, 21.159, 20.564, 19.627, 21.856, 21.993, 23.394, 23.676, 20.086, 18.855, 18.316, 22.151, 23.936, 21.965, 19.992, 20.611, 22.737, 19.753, 17.273, 18.49, 19.122, 22.069, 23.774, 24.005, 22.798, 22.919, 21.801, 23.984, 20.996, 21.63, 23.113, 21.637, 21.962, 22.697, 20.439, 20.362, 19.163, 21.737], [19.505, 23.634, 24.572, 21.257, 22.365, 22.171, 22.872, 22.541, 22.738, 22.101, 21.081, 23.377, 23.073, 23.477, 22.565, 19.647, 19.034, 22.042, 22.995, 21.545, 21.262, 19.395, 20.577, 19.929, 21.015, 25.317, 21.567, 20.446, 20.686, 22.126, 22.463, 26.016, 19.326, 21.519], [23.011, 20.187, 24.888, 19.675, 22.362, 22.899, 23.705, 18.407, 19.909, 22.397, 21.619, 25.248, 19.78, 21.912, 21.072, 24.173, 24.741, 21.456, 25.608, 24.412, 23.772, 22.04, 22.935, 26.711, 21.239, 23.288, 25.425, 25.549, 26.462, 23.062, 24.589, 25.973, 17.817, 20.955, 23.33, 21.238, 21.758, 21.764, 20.075, 22.282, 22.443, 21.497], [24.998, 23.199, 24.564, 23.305, 21.669, 23.958, 20.043, 24.744, 21.369, 21.773, 25.09, 21.549, 21.646, 23.882, 19.752, 20.461, 24.172, 18.651, 19.358, 24.346, 23.524, 18.669, 27.402, 28.228, 23.964, 25.803, 25.103, 31.498, 21.026, 25.755, 29.74, 27.204, 28.405, 28.966, 26.213, 24.32, 23.211, 23.859, 28.739, 25.716, 23.64, 26.643, 21.509, 24.249, 23.763, 23.695, 25.571, 30.322, 19.773, 25.217, 20.13, 23.174, 23.435, 19.243], [22.682, 19.794, 21.093, 22.4, 19.38, 20.579, 23.66, 19.336, 22.758, 25.699, 19.641, 23.905, 24.584, 25.669, 20.581, 21.199, 28.37, 23.117, 26.876, 24.103, 20.644, 23.155, 25.041, 21.443, 21.478, 24.343, 23.932, 20.316, 26.149, 26.703, 24.217, 22.674, 23.726, 21.028, 29.392, 25.359, 25.933], [21.317, 19.829, 20.617, 22.719, 17.201, 19.895, 25.303, 20.262, 22.63, 18.08, 16.589, 23.359, 21.419, 22.001, 18.734, 21.036, 21.829, 21.459, 18.159, 24.658, 23.233, 22.936, 22.269, 21.946, 26.973, 22.128, 20.899, 20.484, 24.354, 22.53, 22.664], [18.829, 21.207, 23.994, 22.837, 22.911, 25.426, 19.583, 23.591, 18.67, 19.625, 20.57, 24.718, 19.441, 14.327, 21.683, 16.899, 24.77, 18.775, 23.927, 21.333, 23.623, 22.037, 18.531, 22.32, 21.375, 19.328, 21.99, 21.012, 22.04, 17.901], [21.879, 21.116, 21.456, 19.48, 20.194, 24.291, 22.523, 21.01, 20.884, 19.653, 17.11, 21.537, 21.599, 20.109, 21.371, 20.27, 18.325, 21.698, 19.136, 24.769, 18.829, 19.363, 17.872, 17.647, 20.8, 21.373, 17.16, 21.691, 19.126, 16.539, 23.972, 22.975, 18.99, 23.973, 23.239, 18.395]]

i,j = [],[]

for n,x in enumerate(G1):
  for xx in x:
    i.append(NRLs[n])
    j.append(xx)

plt.scatter(i,j)
# plt.show()


x1 = 10
x2 = 0.3
x3 = 5
x4 = 20
x = np.array(NRLs)
def sinusoid(x,x1,x2,x3,x4):
    return x1 * np.sin(x2 * x + x3) + x4
y = sinusoid(x,x1,x2,x3,x4)

popt, pcov = curve_fit(sinusoid, i, j, p0=[x1,x2,x3,x4])
print(popt)
yy = sinusoid(x,popt[0],popt[1],popt[2],popt[3])

plt.plot(x,y, label = "guess")
plt.plot(x,yy, label = "fit", color='red')
plt.show()